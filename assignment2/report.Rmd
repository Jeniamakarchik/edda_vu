---
title: "Assignment 2"
author: "Alexia Salomons, Nathan Maxwell Jones, Yauheniya Makarevich, group 71"
date: "15 March 2023"
output: pdf_document
fontsize: 11pt
highlight: tango
---

```{r setup, include = FALSE}
# set up global R options
options(digits = 3)

# set up knitr global chunk options
knitr::opts_chunk$set(fig.height = 3)
```


## Exercise 1

```{r}
tree_df <- as.data.frame(read.table("data/treeVolume.txt", header=TRUE))
head(tree_df)
```

**a)** 
1-way ANOVA
```{r}
tree_df$type <- as.factor(tree_df$type)
tree_type_lm <- lm(volume~type, data=tree_df)
anova(tree_type_lm)
```
```{r}
summary(tree_type_lm)
```

Therefore tree type does not influence volume significantly. Because the factor has two levels, we can apply a t-test.
```{r}
mask <- tree_df$type == "beech"
t.test(tree_df$volume[mask], tree_df$volume[!mask])
```
This supports the result from the ANOVA test. The estimated volume for Beech trees is 30.2 and 35.2 for Oak trees.


**b)** 

```{r}
tree_type_d_lm <- lm(volume~height+type*diameter, data=tree_df)
anova(tree_type_d_lm)
```

```{r}
summary(tree_type_d_lm)
```


```{r}
tree_type_h_lm <- lm(volume~diameter+type*height, data=tree_df)
anova(tree_type_h_lm)
```

```{r}
summary(tree_type_h_lm)
```

As we can see, both pair-wise interactions are not significant. Therefore, we can consider that both height and diameter have the same influence regardless of tree type. 

**c)** 

We saw that the interactions of height and diameter with type were not significant, and so we will investigate a purely additive model.

```{r}
tree_type_all_lm <- lm(volume~diameter+height+type, data=tree_df)
anova(tree_type_all_lm)
```
```{r}
summary(tree_type_all_lm)
```

Type is insidnificant in additive model, so we are going to check the model without type variable.

```{r}
tree_all_lm <- lm(volume~diameter+height, data=tree_df)
anova(tree_all_lm)
```
```{r}
summary(tree_all_lm)
```
We get almost the same R-squared value using this simpler model, and so this is our model of choice. Therefore, we conclude that type does not affect volume significantly. Looking at the coefficients, we see that increasing both height and diameter result in an increase in volume, with diameter having a bigger impact. This makes sense... we gonna sus this out a lil further in the next question ma dude.

$$volume = -64.37 + 4.63 * diameter + 0.43 * height$$
```{r}
mean_d <- mean(tree_df$diameter)
mean_h <- mean(tree_df$height)

means <-  data.frame(diameter=c(mean_d), height=c(mean_h))
means
predict(tree_all_lm, means, se.fit = TRUE)
```
We expect average volume to be 32.6.

**d)** 

```{r}
tree_df$math_volume <- tree_df$height*tree_df$diameter^2
updated_lm <- lm(volume~math_volume, data=tree_df)
anova(updated_lm)
```

```{r}
summary(updated_lm)
```
```{r, echo=FALSE}
par(mfrow=c(1,2))

qqnorm(residuals(updated_lm))
plot(fitted(updated_lm), residuals(updated_lm))
```

Looks okay.

## Exercise 2

```{r, include=FALSE}
# Read data
```

**a)** 

```{r}

```

**b)** 

```{r}

```

**c)** 

```{r}

```

**d)** 

```{r}

```

## Exercise 3

```{r, include=FALSE}
# Read data
```

**a)** 

```{r}

```

**b)** 

```{r}

```

**c)** 

```{r}

```

**d)** 

```{r}

```

**e)** 

```{r}

```

## Exercise 4

```{r, include=FALSE}
# Read data
```

**a)** 

```{r}

```

**b)** 

```{r}

```

**c)** 

```{r}

```

